[toc]

<hr>

因果推断(Causal Inference)无疑是现代计量经济学的核心内容。这一系列推送就是作者学习现在流行的*Most Harmless Econometrics* 这一套框架过程中整理的笔记。并结合了一些理论模型，更深入地去体会研究设计、模型设定这些与经济理论本身关联更紧密的方面。因为我也只是一个经济学研究的小白，所以欢迎大家在评论区批评指正，共同学习。

## 因果关系与潜在结果框架 

因果(Causality)从广义而言就是事件$A$对事件$B$的影响。在不同的学科范畴内关于因果的解释也不相同，在经济学领域，采用反事实的因果框架，这一框架可以追溯到大卫·休谟在《人性论》中关于因果关系的探讨。

![休谟所著的《人性论》指出了归纳推理的缺陷，认为人类对因果关系的信念仅仅来自于习惯（habit）和传统（custom）。](https://github.com/Runsheng-Wang/Treatment/blob/master/fig/A_Treatise_of_Human_Nature_by_David_Hume.jpg?raw=true "休谟的名著《人性论》指出因果仅仅来源于信念。")

休谟的名著《人性论》指出因果仅仅来源于信念。作为经验主义和怀疑主义的代表，休谟从知识的起源这一形而上的角度对因果关系提出了质疑，并且看上去难以驳斥，但也为后来现代统计找寻方向打了一束或明或暗的光：反事实的角度。用休谟本来的语言是 "where, if the first object had not been, the second never had existed"。 直到 Neyman（1923）设计了著名的农田实验，提出了著名的潜在结果模型。自此，随机化实验的思想逐渐开始进入医药、生物实验，而近二十年，大量的随机化实验出现在社会科学中，用来研究复杂社会问题中的因果关系。参照理想化的随机试验设计，经济学所关心的因果效应就是处置效应，被定义为：**在排除任何潜在混淆因素(confoundness)的影响后，处理变量$D_i$（treatment） 对结果变量（目标变量）的影响**。如果理想的实验能够实施，那么 我们直接比较两个分组的特征就可以评估一个项目（处置）对个体的影响。然而，很多与社会科学领域相关的实验存在伦理问题。所以经济计量分析很难获取理想的实验数据（experimental data），例如，我们无法将儿童随机分配进入不同的受教育组别，我们仅能观测到进入劳动力市场个体的受教育程度，这意味着所有观测到的经济变量都是随机的，或者说是某一个数据生成过程（Data Generate Process, DGP）的实现情况，并且我们观察到的结果是由很多变量共同决定的。那么计量经济学要解决的核心问题就是研究在哪些假设和方法下可以用观察数据来识别并估计因果效应，一般而言，给定假设进行识别，根据识别确定方法，最后给出估计。

假定我们所关心的处理变量$D$是一个二元变量（对于受到处置的个体$i$，$D$ 取 $1$，对于未受处置的个体 $i$，$D$取$0$），比如实施了宽松的货币政策或是紧缩的货币政策；比如政府针对农民工进行就业技能培训；再比如个体选择是否读大学等等$\cdots$ 现实生活的很多政策看上去*似乎*都可以抽象为这样一个$D_i \in \{0,1\}$二元变量。那么对因果效应的评估也就可以通过观察处理和控制两种状态下的差异实现：
$$TE_i = Y_{1i}-Y_{0i},$$
对于观测数据而言，$Y_{1i}$和$Y_{0i}$是不可能同时观测的，例如当个体$i$取得大学学历以后，我们就只能观测到他在该状态下的工资水平，但无法观测他没上大学的工资水平。

当然，观测结果和潜在结果并不是毫无关联，这边需要引入潜在结果框架：
$$Y_i = 
\begin{cases}
    Y_{0i}, & \text{if} \ D_i = 0, \ \text{untreated}, \\
    Y_{1i}, & \text{if} \ D_i = 1, \ \text{treated}.
\end{cases}$$
利用$D$是一个$0,1$二元变量，可以写得更简约：
$$ Y_i = Y_{0i} + D_i(Y_{1i} - Y_{0i}), \tag{1} $$
或者
$$ Y_i = (1 - D_i) Y_{0i} + D_i Y_{1i}, \tag{1*}
$$
其中，$Y_{1i}$和$Y_{0i}$均被假设为独立同分布的[随机变量](与其说是假设，更像是一种“信念”，是一种看待经济现象的观念。 "随机化假设")。等式$(1)$（或$(1*)$）就是所谓的潜在结果模型(potential outcome model)。该模型在数学上是简单的，但是实现了观测结果与潜在结果的关联。对于一般的处置效应$TE_i$来说，同时观测到$Y_{1i}$和$Y_{0i}$是不现实的，想要对$TE_i$的整个分布有所了解也是困难的，因此计量经济学更关注分布的矩，尤其是期望。便有了政策干预的平均处理效应（Average Treatment Effect）的定义：
$$ATE = \mathbb{E} \left[ Y_{1i}-Y_{0i} \right],
$$
如下图所示：

![处置效应的密度分布](https://github.com/Runsheng-Wang/Treatment/blob/master/fig/fontp1.png?raw=true)

## 识别与估计：让回归有意义 

### 随机分配下的识别

我们


### 贝叶斯解读

## 非随机分配与选择偏差 

### 分解选择偏差 

## 在统计软件中实现

